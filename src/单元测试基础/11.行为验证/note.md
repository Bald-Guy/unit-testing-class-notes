# 行为验证
**定义：验证对象之间的交互是否按照预期进行。**

这里的交互是指调用函数，调用某个对象里的方法，而不是用户的交互

行为验证背后的逻辑: 状态的改变是由交互引起的。如果所有的交互都正确，那么就可以推断最终的状态也不会错。

为了验证对象之间的交互，就需要获取到交互的信息：函数是否被调用，函数被调用时的参数是什么，函数被调用了几次，这些交互信息应该如何获取？使用 mock！注意 stub 和 mock 的区别

mock的三种职责：测试替身、记录交互信息、提供数据及验证 -> vi.fn vi.spyOn

## 缺点：
- 破坏了封装性: 白盒测试，暴露了内部的实现细节, 当内部实现细节发生变化时, 测试代码也需要进行相应改动
- 丧失了测试的有效性: 如果内部实现出问题，是检测不出来的，也就意味着状态不会改变, 但是交互行为却是正确的(这样就和为了追求测试覆盖率, 只调用不验证状态的做法是一样的, 都是无效的)

## 使用的时机

1. 优先使用状态验证

2. 当找不到状态, 或者状态很难获取的时候, 考虑使用行为验证

3. 当考虑到成本（调用数据库）的时候, 考虑使用行为验证